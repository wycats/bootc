{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "BaseImageAssumptions",
  "description": "Tracks what the upstream Bazzite base image provides (packages, services, paths). This is a reference manifest for drift detection and CI verification, NOT a list of runtime dependencies. Used to detect when upstream changes break our assumptions.\n\nStored at `manifests/base-image-assumptions.json`.",
  "type": "object",
  "properties": {
    "base_image": {
      "description": "Information about the upstream base image being tracked",
      "$ref": "#/$defs/BaseImageInfo",
      "default": {}
    },
    "packages": {
      "description": "Packages that the upstream Bazzite image provides (what's already in the base image)",
      "type": "array",
      "default": [],
      "items": {
        "$ref": "#/$defs/PackageAssumption"
      }
    },
    "paths": {
      "description": "Filesystem paths that the upstream Bazzite image provides",
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "services": {
      "description": "Systemd services that the upstream Bazzite image provides",
      "type": "array",
      "items": {
        "type": "string"
      }
    }
  },
  "$defs": {
    "BaseImageInfo": {
      "description": "Information about the base container image.",
      "type": "object",
      "properties": {
        "last_verified_at": {
          "description": "When the assumptions were last verified against the image",
          "type": [
            "string",
            "null"
          ]
        },
        "last_verified_digest": {
          "description": "The last verified sha256 digest",
          "type": [
            "string",
            "null"
          ]
        },
        "source": {
          "description": "The source image reference (e.g., \"ghcr.io/ublue-os/bazzite-gnome:stable\")",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "PackageAssumption": {
      "description": "A package assumption - a package expected to be in the base image.",
      "type": "object",
      "properties": {
        "name": {
          "description": "Package name",
          "type": "string"
        },
        "reason": {
          "description": "Why this package is assumed (optional documentation)",
          "type": [
            "string",
            "null"
          ]
        }
      },
      "required": [
        "name"
      ]
    }
  }
}